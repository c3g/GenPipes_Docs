.. _docs_steps_cov_nanopore:

Step Details
-------------

Following are the various steps that are part of GenPipes CoVSeq genomic analysis pipeline:

.. _BlastQC:

**BlastQC**

In this step, `Blast-QC utility`_ is used for sequence alignment and identification. It performs a basic QC test by aligning 1000bp of randomly selected reads to the `NCBI Nucleotide Database`_ in order to detect potential contamination.

.. _Minimap2 Align:

**Minimap2 Align**

`Minimap2 Align Program`_ is a fast, general purpose sequencing alignment program that maps DNA and long mRNA sequences against a large reference database.  It can be used for Nanopore sequencing for mapping 1kb genomic reads at an error rate of 15% (e.g., PacBio or Oxford Nanopore genomic reads), among other uses.

In this step,  minimap2 to align the Fastq reads that passed the minimum QC threshold to the provided reference genome. By default, it aligns to the human genome reference (GRCh38) with Minimap2.

.. _pycoQC:

**pycoQC**

In this step, `pycoQC Software`_ is used  produce an interactive quality report based on the summary file and alignment outputs. PycoQC relies on the sequencing_summary.txt file generated by Guppy. If needed, it can also generate a summary file from basecalled FAST5 files. PycoQC computes metrics and generates interactive QC plots for Oxford Nanopore technologies sequencing data.

.. _Picard Merge SAM Files:

**Picard Merge SAM Files**

BAM readset files are merged into one file per sample in this step. Using aligned and sorted BAM output files from :ref:`Minimap2 Align<Minimap2 Align>` step, it performs the merge using `Picard`_.

.. _Structural Variant Identification using Mapped Long Reads:

**Structural Variant Identification using Mapped Long Reads**

In this step, Structural Variant Identification using Mapped Long Reads (`SVIM methodology`_), is used to perform structural variant (SV) analysis on each sample.

.. References

.. _Blast-QC utility: https://environmentalmicrobiome.biomedcentral.com/articles/10.1186/s40793-020-00361-y
.. _NCBI Nucleotide Database: https://www.ncbi.nlm.nih.gov/nucleotide/
.. _Minimap2 Align Program: https://chipster.csc.fi/manual/minimap2.html
.. _pycoQC software: https://github.com/a-slide/pycoQC
.. _Picard: http://broadinstitute.github.io/picard/
.. _SVIM methodology:  https://pubmed.ncbi.nlm.nih.gov/30668829/
